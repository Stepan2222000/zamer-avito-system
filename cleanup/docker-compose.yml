services:
  cleanup:
    build:
      context: .
      dockerfile: Dockerfile

    container_name: zamer_avito_cleanup

    # Автоматический перезапуск при падении
    restart: unless-stopped

    # Переменные окружения (ХАРДКОД согласно CLAUDE.md)
    environment:
      # Database
      DB_HOST: "81.30.105.134"
      DB_PORT: "5413"
      DB_NAME: "zamer_avito_system"
      DB_USER: "admin"
      DB_PASSWORD: "Password123"

      # Timeouts (секунды)
      TASK_TIMEOUT: "600"        # 10 минут - задачи в processing
      PROXY_TIMEOUT: "300"       # 5 минут - прокси locked
      WORKER_TIMEOUT: "240"      # 4 минуты - workers без heartbeat
      DB_CONNECT_TIMEOUT: "10"

      # Cleanup cycle
      CLEANUP_INTERVAL: "60"     # 60 секунд между циклами

      # Retry logic
      DB_RETRY_ATTEMPTS: "5"
      RETRY_DELAY: "10"
